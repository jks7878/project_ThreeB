<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
   
 <mapper namespace="mapper.search">
	<resultMap id="houseResult" type="houseVO">
		<result property="houseId" column="house_id"/>
		<result property="memberId" column="member_id"/>
		<result property="houseType" column="house_type"/>
		<result property="housePerson" column="house_person"/>
		<result property="houseRoom" column="house_room"/>
		<result property="houseBed" column="house_bed"/>
		<result property="houseBedType" column="house_bed_type"/>
		<result property="houseBath" column="house_bath"/>
		<result property="location" column="house_location"/>
		<result property="houseFacility" column="house_facility"/>
		<result property="houseTitle" column="house_title"/>
		<result property="houseContent" column="house_content"/>
		<result property="houseCharge" column="house_charge"/>
		<result property="houseWritedate" column="house_writedate"/>
	</resultMap>
	
	
	<select id="selectAllHouse" resultMap="houseResult" parameterType="String">
      <![CDATA[
			select * from
			(select distinct A.*
			from threeb_house A, threeb_booking B 
			where (A.house_id not in (select house_id from threeb_booking)) 
			or (A.house_id = B.house_id and (B.checkout < #{start} or B.checkin > #{end})))
			where house_location like '%' || #{location} || '%'
      ]]>
	</select>
</mapper>